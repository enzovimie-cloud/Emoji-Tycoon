<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Emoji Tycoon ULTIMATE</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üî•</text></svg>">
    
    <style>
        /* EST√âTICA FUTURISTA */
        :root { --bg: #1a1a2e; --panel: #16213e; --accent: #e94560; --gold: #ffd700; --text: #fff; }
        body { background-color: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; margin: 0; height: 100vh; overflow: hidden; display: flex; flex-direction: column; user-select: none; }
        
        /* UI SUPERIOR */
        .header { background: rgba(0,0,0,0.6); padding: 15px; display: flex; justify-content: space-between; border-bottom: 2px solid var(--accent); z-index: 10; backdrop-filter: blur(5px); }
        .currency { text-align: right; }
        .money { color: #2ecc71; font-weight: 800; font-size: 1.2rem; text-shadow: 0 0 5px #2ecc71; }
        .gems { color: var(--gold); font-weight: bold; font-size: 1rem; }
        .lvl-bar { width: 100%; height: 5px; background: #333; position: absolute; bottom: 0; left: 0; }
        .lvl-fill { height: 100%; background: var(--accent); width: 0%; transition: width 0.5s; }

        /* JUEGO CENTRAL */
        .game-zone { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; background: radial-gradient(circle, #1f4068 0%, #1a1a2e 70%); }
        
        #main-emoji { font-size: 6rem; cursor: pointer; transition: transform 0.05s; filter: drop-shadow(0 0 15px rgba(233, 69, 96, 0.5)); -webkit-tap-highlight-color: transparent; }
        #main-emoji:active { transform: scale(0.9) rotate(5deg); }

        /* POPUP OFFLINE (EL GANCHO) */
        #offline-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 999; display: none; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        .modal-content { background: var(--panel); padding: 30px; border-radius: 20px; border: 2px solid var(--gold); max-width: 80%; box-shadow: 0 0 50px rgba(255, 215, 0, 0.3); }
        .modal-btn { padding: 15px 30px; margin: 10px; border: none; border-radius: 50px; font-weight: bold; font-size: 1rem; cursor: pointer; width: 100%; }
        .btn-claim { background: #555; color: white; }
        .btn-double { background: linear-gradient(45deg, #f1c40f, #e67e22); color: black; animation: pulse 1.5s infinite; }

        /* PESTA√ëAS Y PANELES */
        .tabs { display: flex; background: #0f3460; }
        .tab { flex: 1; padding: 15px; background: none; border: none; color: #aaa; font-weight: bold; }
        .tab.active { color: white; background: var(--panel); border-top: 3px solid var(--accent); }
        
        .panel-container { height: 50%; background: var(--panel); overflow-y: auto; padding-bottom: 50px; }
        .panel { display: none; padding: 15px; }
        .panel.active { display: block; animation: fadeIn 0.3s; }

        /* TIENDA ITEMS */
        .item { background: rgba(255,255,255,0.05); padding: 12px; margin-bottom: 8px; border-radius: 10px; display: flex; justify-content: space-between; align-items: center; border-left: 4px solid var(--accent); }
        .buy-btn { background: #2ecc71; color: #000; padding: 8px 15px; border-radius: 5px; border: none; font-weight: bold; }
        .buy-btn:disabled { background: #555; color: #888; }

        /* CAJA MISTERIOSA */
        .mystery-box { background: linear-gradient(135deg, #6c5ce7, #a29bfe); padding: 20px; border-radius: 15px; text-align: center; margin-bottom: 20px; border: 2px dashed white; cursor: pointer; }
        .mystery-box:active { transform: scale(0.98); }

        /* ANIMACIONES */
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .particle { position: absolute; color: #2ecc71; font-weight: bold; pointer-events: none; animation: floatUp 0.8s forwards; }
        @keyframes floatUp { to { transform: translateY(-100px); opacity: 0; } }
    </style>
</head>
<body>

    <div id="offline-modal">
        <div class="modal-content">
            <h2 style="color:var(--gold)">¬°BIENVENIDO JEFE!</h2>
            <p>Tus empleados trabajaron mientras no estabas.</p>
            <h1 id="offline-amount" style="color:#2ecc71">$0</h1>
            
            <button class="modal-btn btn-double" onclick="claimOffline(true)">
                üì∫ DOBLE ($ x2)
            </button>
            <button class="modal-btn btn-claim" onclick="claimOffline(false)">
                Reclamar Normal
            </button>
        </div>
    </div>

    <div class="header">
        <div>
            <div style="font-size:0.8rem; color:#aaa;">NIVEL <span id="lvl-num">1</span></div>
            <strong>EMOJI CORP</strong>
            <div class="lvl-bar"><div class="lvl-fill" id="lvl-fill"></div></div>
        </div>
        <div class="currency">
            <div class="money" id="money-ui">$0</div>
            <div class="gems" id="gems-ui">üíé 0</div>
        </div>
    </div>

    <div class="game-zone">
        <div id="main-emoji" onclick="doClick(event)">üöÄ</div>
        
        <div style="position: absolute; bottom: 5px; color: #555; font-size: 0.7rem;">
            [Publicidad]
        </div>
    </div>

    <div class="tabs">
        <button class="tab active" onclick="tab('prod')">üè≠ M√°quinas</button>
        <button class="tab" onclick="tab('upgrades')">‚ö° Mejoras</button>
        <button class="tab" onclick="tab('shop')">üíé Tienda</button>
    </div>

    <div class="panel-container">
        <div id="prod" class="panel active"></div>
        
        <div id="upgrades" class="panel"></div>

        <div id="shop" class="panel">
            
            <div class="mystery-box" onclick="openMysteryBox()">
                <div style="font-size: 2rem;">üéÅ</div>
                <h3>CAJA MISTERIOSA</h3>
                <p>Cuesta: <strong>15 üíé</strong></p>
                <small>¬°Puede contener dinero o el Multiplicador x5!</small>
            </div>

            <button class="modal-btn btn-double" onclick="watchAdForGems()">
                üé¨ VER ANUNCIO (+10 üíé)
            </button>

            <div class="item" style="border-color: gold; margin-top:20px;">
                <div>
                    <h4>‚è≥ Viaje al Futuro</h4>
                    <small>Adelanta 1 hora de ganancias</small>
                </div>
                <button class="buy-btn" onclick="buyTimeWarp()" style="background:gold;">30 üíé</button>
            </div>
        </div>
    </div>

<script>
    // --- DATOS DEL JUEGO ---
    const machinesDB = [
        {name: "Becario", cost: 15, prod: 1, icon: "ü§ì"},
        {name: "Servidor", cost: 100, prod: 5, icon: "üñ•Ô∏è"},
        {name: "Hacker", cost: 1100, prod: 40, icon: "üë®‚Äçüíª"},
        {name: "Botnet", cost: 12000, prod: 300, icon: "ü§ñ"},
        {name: "IA Maestra", cost: 150000, prod: 2000, icon: "üß†"}
    ];
    
    // Estado inicial
    let game = {
        money: 0,
        gems: 5, // Regalamos 5 al empezar para enganchar
        qtys: [0,0,0,0,0],
        upgrades: [],
        lastSave: Date.now(),
        prestige: 1,
        totalEarnings: 0 // Para calcular nivel
    };

    // --- CARGAR / GUARDAR ---
    if(localStorage.getItem('emojiUltimate')) {
        game = JSON.parse(localStorage.getItem('emojiUltimate'));
        checkOfflineEarnings();
    } else {
        // Usuario nuevo
        setTimeout(() => alert("¬°Bienvenido CEO! Haz clic en el cohete para empezar."), 500);
    }

    function save() {
        game.lastSave = Date.now();
        localStorage.setItem('emojiUltimate', JSON.stringify(game));
    }

    // --- SISTEMA OFFLINE (RETENCI√ìN) ---
    let pendingOfflineCash = 0;

    function checkOfflineEarnings() {
        const now = Date.now();
        const secondsGone = (now - game.lastSave) / 1000;
        
        if(secondsGone > 60) { // Si se fue m√°s de 1 minuto
            const pps = getPPS();
            if(pps > 0) {
                pendingOfflineCash = pps * secondsGone;
                document.getElementById('offline-amount').innerText = `$${Math.floor(pendingOfflineCash).toLocaleString()}`;
                document.getElementById('offline-modal').style.display = 'flex';
            }
        }
    }

    function claimOffline(isDouble) {
        if(isDouble) {
            // TRUCO: Abrimos publi y damos el doble
            showAd(() => {
                game.money += pendingOfflineCash * 2;
                game.totalEarnings += pendingOfflineCash * 2;
                closeModal();
                alert("¬°Doble ganancia recibida!");
            });
        } else {
            game.money += pendingOfflineCash;
            game.totalEarnings += pendingOfflineCash;
            closeModal();
        }
    }
    
    function closeModal() {
        document.getElementById('offline-modal').style.display = 'none';
        save(); render();
    }

    // --- L√ìGICA DE DINERO ---
    function getPPS() { // Producci√≥n por segundo
        let p = 0;
        machinesDB.forEach((m, i) => p += (m.prod * game.qtys[i]));
        return p * game.prestige;
    }

    setInterval(() => {
        const inc = getPPS() / 10;
        if(inc > 0) {
            game.money += inc;
            game.totalEarnings += inc;
            updateLevel();
        }
        document.getElementById('money-ui').innerText = `$${Math.floor(game.money).toLocaleString()}`;
        save();
    }, 100);

    // --- ACCIONES ---
    function doClick(e) {
        const clickVal = (1 + (getPPS() * 0.05)) * game.prestige; // El click escala con tu producci√≥n
        game.money += clickVal;
        game.totalEarnings += clickVal;
        
        // Efecto Part√≠cula
        const p = document.createElement('div');
        p.innerText = `+$${Math.floor(clickVal)}`;
        p.className = 'particle';
        p.style.left = e.clientX + 'px';
        p.style.top = (e.clientY - 40) + 'px';
        document.body.appendChild(p);
        setTimeout(()=>p.remove(), 800);
        
        updateLevel();
        save();
        document.getElementById('money-ui').innerText = `$${Math.floor(game.money).toLocaleString()}`;
    }

    function buyItem(i) {
        const m = machinesDB[i];
        const cost = Math.floor(m.cost * Math.pow(1.15, game.qtys[i]));
        if(game.money >= cost) {
            game.money -= cost;
            game.qtys[i]++;
            save(); render();
        }
    }

    // --- TIENDA DE GEMAS & CAJA MISTERIOSA ---
    
    function openMysteryBox() {
        if(game.gems >= 15) {
            game.gems -= 15;
            save(); render();
            
            // RULETA DE PROBABILIDAD
            const rand = Math.random();
            if(rand < 0.5) { // 50% Dinero peque√±o
                const premio = getPPS() * 100 + 500;
                game.money += premio;
                alert(`üì¶ CAJA COM√öN: Ganaste $${Math.floor(premio)}`);
            } else if(rand < 0.8) { // 30% Dinero grande
                const premio = getPPS() * 600 + 2000;
                game.money += premio;
                alert(`üì¶üì¶ CAJA RARA: ¬°Ganaste $${Math.floor(premio)}!`);
            } else if(rand < 0.95) { // 15% Gemas devuelta
                game.gems += 20;
                alert(`üíé CAJA DE GEMAS: ¬°20 Gemas!`);
            } else { // 5% PREMIO GORDO
                game.prestige += 0.5;
                alert(`üëë CAJA LEGENDARIA: ¬°Tu multiplicador de beneficios ha subido +0.5x!`);
            }
        } else {
            alert("No tienes suficientes gemas (15) üíé");
        }
    }

    function buyTimeWarp() {
        if(game.gems >= 30) {
            game.gems -= 30;
            game.money += getPPS() * 3600; // 1 hora
            alert("¬°VIAJE EN EL TIEMPO! Ganancia de 1 hora recibida.");
            save(); render();
        }
    }

    function watchAdForGems() {
        showAd(() => {
            game.gems += 10;
            save(); render();
            alert("¬°+10 Gemas Recibidas!");
        });
    }

    // --- INTEGRACI√ìN PUBLICIDAD (AQU√ç EST√Å TU DINERO) ---
    
    let lastAdTime = 0;
    
    function showAd(callback) {
        const now = Date.now();
        if(now - lastAdTime < 15000) { // 15 segundos entre anuncios
            alert("El sat√©lite de anuncios se est√° recargando...");
            return;
        }

        // ‚ñº‚ñº‚ñº‚ñº PEGA TU LINK DIRECTO DE ADSTERRA AQU√ç ABAJO ‚ñº‚ñº‚ñº‚ñº
        const adLink = "https://www.effectivegatecpm.com/ttwcdab5?key=8d51779f7c6cbf2f752d275eb491f8dc";
        // ‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤‚ñ≤

        window.open(adLink, '_blank');
        lastAdTime = now;
        
        // Retraso para simular que vio el anuncio
        setTimeout(() => {
            if(callback) callback();
        }, 1000);
    }

    // --- UI HELPERS ---
    function updateLevel() {
        // Nivel basado en dinero total ganado (logar√≠tmico)
        const lvl = Math.floor(Math.log10(game.totalEarnings + 1)) + 1;
        document.getElementById('lvl-num').innerText = lvl;
        
        // Barra de progreso (visual)
        const nextLvlReq = Math.pow(10, lvl);
        const prevLvlReq = Math.pow(10, lvl-1);
        const progress = (game.totalEarnings - prevLvlReq) / (nextLvlReq - prevLvlReq) * 100;
        document.getElementById('lvl-fill').style.width = Math.min(progress, 100) + '%';
    }

    function tab(id) {
        document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        event.target.classList.add('active');
    }

    function render() {
        document.getElementById('gems-ui').innerText = `üíé ${game.gems}`;
        
        const div = document.getElementById('prod');
        div.innerHTML = "";
        machinesDB.forEach((m, i) => {
            const cost = Math.floor(m.cost * Math.pow(1.15, game.qtys[i]));
            div.innerHTML += `
            <div class="item">
                <div style="display:flex; align-items:center;">
                    <div style="font-size:1.8rem; margin-right:10px;">${m.icon}</div>
                    <div>
                        <div style="font-weight:bold;">${m.name}</div>
                        <div style="font-size:0.8rem; color:#aaa;">Tienes: ${game.qtys[i]} | +$${m.prod}/s</div>
                    </div>
                </div>
                <button class="buy-btn" onclick="buyItem(${i})" ${game.money < cost ? 'disabled' : ''}>
                    $${cost.toLocaleString()}
                </button>
            </div>`;
        });
    }

    // Inicio
    render();
    updateLevel();

</script>
</body>
</html>
